2023-10-23 11:20:00,520 INFO    MainThread:103779 [wandb_setup.py:_flush():76] Configure stats pid to 103779
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_setup.py:_flush():76] Loading settings from /home/yuchen/.config/wandb/settings
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_setup.py:_flush():76] Loading settings from wandb/settings
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'start_method': 'thread', 'root_dir': '.'}
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'code/stageA1_mbm_pretrain.py', 'program': 'code/stageA1_mbm_pretrain.py'}
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_setup.py:_flush():76] Applying login settings: {'anonymous': 'allow'}
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_init.py:_log_setup():461] Logging user logs to ./wandb/run-20231023_112000-2qgi689v/logs/debug.log
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_init.py:_log_setup():462] Logging internal logs to ./wandb/run-20231023_112000-2qgi689v/logs/debug-internal.log
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_init.py:init():495] calling init triggers
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_init.py:init():498] wandb.init called with sweep_config: {}
config: {'lr': 0.00025, 'min_lr': 0.0, 'weight_decay': 0.05, 'num_epoch': 500, 'warmup_epochs': 40, 'batch_size': 100, 'clip_grad': 0.8, 'mask_ratio': 0.75, 'patch_size': 16, 'embed_dim': 1024, 'decoder_embed_dim': 512, 'depth': 24, 'num_heads': 16, 'decoder_num_heads': 16, 'mlp_ratio': 1.0, 'root_path': '.', 'output_path': './results/fmri_pretrain/23-10-2023-11-20-00', 'seed': 2022, 'roi': 'VC', 'aug_times': 1, 'num_sub_limit': None, 'include_hcp': True, 'include_kam': True, 'accum_iter': 1, 'use_nature_img_loss': False, 'img_recon_weight': 0.5, 'focus_range': None, 'focus_rate': 0.6, 'local_rank': 0}
2023-10-23 11:20:00,521 INFO    MainThread:103779 [wandb_init.py:init():548] starting backend
2023-10-23 11:20:00,532 INFO    MainThread:103779 [backend.py:ensure_launched():217] starting backend process...
2023-10-23 11:20:00,533 INFO    MainThread:103779 [backend.py:ensure_launched():222] started backend process with pid: 0
2023-10-23 11:20:00,533 INFO    BackendThr:103779 [internal.py:wandb_internal():90] W&B internal server running at pid: 103779, started at: 2023-10-23 11:20:00.533231
2023-10-23 11:20:00,534 INFO    MainThread:103779 [wandb_init.py:init():558] backend started and connected
2023-10-23 11:20:00,539 INFO    MainThread:103779 [wandb_init.py:init():634] updated telemetry
2023-10-23 11:20:00,544 INFO    WriterThread:103779 [datastore.py:open_for_write():75] open: ./wandb/run-20231023_112000-2qgi689v/run-2qgi689v.wandb
2023-10-23 11:20:00,559 INFO    MainThread:103779 [wandb_init.py:init():665] communicating run to backend with 30 second timeout
2023-10-23 11:20:01,003 INFO    MainThread:103779 [wandb_run.py:_on_init():1919] communicating current version
2023-10-23 11:20:01,014 INFO    SenderThread:103779 [dir_watcher.py:__init__():216] watching files in: ./wandb/run-20231023_112000-2qgi689v/files
2023-10-23 11:20:01,014 INFO    SenderThread:103779 [sender.py:_start_run_threads():815] run started: 2qgi689v with start time 1698085200
2023-10-23 11:20:01,015 INFO    SenderThread:103779 [sender.py:_save_file():952] saving file wandb-summary.json with policy end
2023-10-23 11:20:01,137 INFO    MainThread:103779 [wandb_run.py:_on_init():1923] got version response upgrade_message: "wandb version 0.15.12 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2023-10-23 11:20:01,137 INFO    MainThread:103779 [wandb_init.py:init():700] starting run threads in backend
2023-10-23 11:20:02,015 INFO    Thread-10 :103779 [dir_watcher.py:_on_file_created():269] file/dir created: ./wandb/run-20231023_112000-2qgi689v/files/requirements.txt
2023-10-23 11:20:02,015 INFO    Thread-10 :103779 [dir_watcher.py:_on_file_created():269] file/dir created: ./wandb/run-20231023_112000-2qgi689v/files/conda-environment.yaml
2023-10-23 11:20:02,015 INFO    Thread-10 :103779 [dir_watcher.py:_on_file_created():269] file/dir created: ./wandb/run-20231023_112000-2qgi689v/files/wandb-summary.json
2023-10-23 11:20:02,580 INFO    SenderThread:103779 [sender.py:_save_file():952] saving file wandb-metadata.json with policy now
2023-10-23 11:20:02,583 INFO    MainThread:103779 [wandb_run.py:_console_start():1893] atexit reg
2023-10-23 11:20:02,584 INFO    MainThread:103779 [wandb_run.py:_redirect():1766] redirect: SettingsConsole.WRAP
2023-10-23 11:20:02,584 INFO    MainThread:103779 [wandb_run.py:_redirect():1803] Wrapping output streams.
2023-10-23 11:20:02,585 INFO    MainThread:103779 [wandb_run.py:_redirect():1827] Redirects installed.
2023-10-23 11:20:02,585 INFO    MainThread:103779 [wandb_init.py:init():732] run started, returning control to user process
2023-10-23 11:20:03,031 INFO    Thread-10 :103779 [dir_watcher.py:_on_file_modified():286] file/dir modified: ./wandb/run-20231023_112000-2qgi689v/files/conda-environment.yaml
2023-10-23 11:20:03,032 INFO    Thread-10 :103779 [dir_watcher.py:_on_file_created():269] file/dir created: ./wandb/run-20231023_112000-2qgi689v/files/wandb-metadata.json
2023-10-23 11:20:03,032 INFO    Thread-10 :103779 [dir_watcher.py:_on_file_created():269] file/dir created: ./wandb/run-20231023_112000-2qgi689v/files/output.log
2023-10-23 11:20:03,597 INFO    Thread-14 :103779 [upload_job.py:push():138] Uploaded file /tmp/tmp__8rt14qwandb/1annyb6s-wandb-metadata.json
2023-10-23 11:20:05,032 INFO    Thread-10 :103779 [dir_watcher.py:_on_file_modified():286] file/dir modified: ./wandb/run-20231023_112000-2qgi689v/files/output.log
2023-10-23 11:20:08,005 INFO    MainThread:103779 [wandb_watch.py:watch():47] Watching
2023-10-23 11:20:09,033 INFO    Thread-10 :103779 [dir_watcher.py:_on_file_modified():286] file/dir modified: ./wandb/run-20231023_112000-2qgi689v/files/output.log
2023-10-23 11:20:09,398 INFO    MainThread:103779 [wandb_run.py:_atexit_cleanup():1862] got exitcode: 1
2023-10-23 11:20:09,399 INFO    MainThread:103779 [wandb_run.py:_restore():1834] restore
2023-10-23 11:20:09,623 INFO    SenderThread:103779 [sender.py:send_exit():372] handling exit code: 1
2023-10-23 11:20:09,624 INFO    SenderThread:103779 [sender.py:send_exit():374] handling runtime: 8
2023-10-23 11:20:09,624 INFO    SenderThread:103779 [sender.py:_save_file():952] saving file wandb-summary.json with policy end
2023-10-23 11:20:09,625 INFO    SenderThread:103779 [sender.py:send_exit():380] send defer
2023-10-23 11:20:09,626 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 0
2023-10-23 11:20:09,627 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 766
  total_bytes: 766
}

2023-10-23 11:20:09,627 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 0
2023-10-23 11:20:09,627 INFO    SenderThread:103779 [sender.py:transition_state():393] send defer: 1
2023-10-23 11:20:09,628 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 1
2023-10-23 11:20:09,678 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 1
2023-10-23 11:20:09,678 INFO    SenderThread:103779 [sender.py:transition_state():393] send defer: 2
2023-10-23 11:20:09,678 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 2
2023-10-23 11:20:09,679 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 2
2023-10-23 11:20:09,679 INFO    SenderThread:103779 [sender.py:transition_state():393] send defer: 3
2023-10-23 11:20:09,679 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 3
2023-10-23 11:20:09,679 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 3
2023-10-23 11:20:09,679 INFO    SenderThread:103779 [sender.py:transition_state():393] send defer: 4
2023-10-23 11:20:09,679 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 4
2023-10-23 11:20:09,679 INFO    SenderThread:103779 [sender.py:_save_file():952] saving file wandb-summary.json with policy end
2023-10-23 11:20:09,680 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 4
2023-10-23 11:20:09,680 INFO    SenderThread:103779 [sender.py:transition_state():393] send defer: 5
2023-10-23 11:20:09,680 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 5
2023-10-23 11:20:09,680 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 5
2023-10-23 11:20:09,908 INFO    SenderThread:103779 [sender.py:transition_state():393] send defer: 6
2023-10-23 11:20:09,909 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 6
2023-10-23 11:20:09,909 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 6
2023-10-23 11:20:09,909 INFO    SenderThread:103779 [dir_watcher.py:finish():353] shutting down directory watcher
2023-10-23 11:20:09,909 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 766
  total_bytes: 766
}

2023-10-23 11:20:10,034 INFO    SenderThread:103779 [dir_watcher.py:_on_file_modified():286] file/dir modified: ./wandb/run-20231023_112000-2qgi689v/files/wandb-summary.json
2023-10-23 11:20:10,035 INFO    SenderThread:103779 [dir_watcher.py:_on_file_modified():286] file/dir modified: ./wandb/run-20231023_112000-2qgi689v/files/config.yaml
2023-10-23 11:20:10,035 INFO    SenderThread:103779 [dir_watcher.py:_on_file_modified():286] file/dir modified: ./wandb/run-20231023_112000-2qgi689v/files/output.log
2023-10-23 11:20:10,036 INFO    SenderThread:103779 [dir_watcher.py:finish():383] scan: ./wandb/run-20231023_112000-2qgi689v/files
2023-10-23 11:20:10,036 INFO    SenderThread:103779 [dir_watcher.py:finish():397] scan save: ./wandb/run-20231023_112000-2qgi689v/files/requirements.txt requirements.txt
2023-10-23 11:20:10,036 INFO    SenderThread:103779 [dir_watcher.py:finish():397] scan save: ./wandb/run-20231023_112000-2qgi689v/files/wandb-summary.json wandb-summary.json
2023-10-23 11:20:10,036 INFO    SenderThread:103779 [dir_watcher.py:finish():397] scan save: ./wandb/run-20231023_112000-2qgi689v/files/config.yaml config.yaml
2023-10-23 11:20:10,037 INFO    SenderThread:103779 [dir_watcher.py:finish():397] scan save: ./wandb/run-20231023_112000-2qgi689v/files/wandb-metadata.json wandb-metadata.json
2023-10-23 11:20:10,037 INFO    SenderThread:103779 [dir_watcher.py:finish():397] scan save: ./wandb/run-20231023_112000-2qgi689v/files/output.log output.log
2023-10-23 11:20:10,054 INFO    SenderThread:103779 [dir_watcher.py:finish():397] scan save: ./wandb/run-20231023_112000-2qgi689v/files/conda-environment.yaml conda-environment.yaml
2023-10-23 11:20:10,055 INFO    SenderThread:103779 [sender.py:transition_state():393] send defer: 7
2023-10-23 11:20:10,061 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 7
2023-10-23 11:20:10,061 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 7
2023-10-23 11:20:10,061 INFO    SenderThread:103779 [file_pusher.py:finish():171] shutting down file pusher
2023-10-23 11:20:10,062 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 766
  total_bytes: 5584
}

2023-10-23 11:20:10,165 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 766
  total_bytes: 15363
}

2023-10-23 11:20:10,277 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 766
  total_bytes: 15363
}

2023-10-23 11:20:10,379 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 8582
  total_bytes: 15363
}

2023-10-23 11:20:10,482 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 15363
  total_bytes: 15363
}

2023-10-23 11:20:10,576 INFO    Thread-21 :103779 [upload_job.py:push():138] Uploaded file ./wandb/run-20231023_112000-2qgi689v/files/requirements.txt
2023-10-23 11:20:10,586 INFO    Thread-22 :103779 [upload_job.py:push():138] Uploaded file ./wandb/run-20231023_112000-2qgi689v/files/wandb-summary.json
2023-10-23 11:20:10,588 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 15363
  total_bytes: 15363
}

2023-10-23 11:20:10,607 INFO    Thread-25 :103779 [upload_job.py:push():138] Uploaded file ./wandb/run-20231023_112000-2qgi689v/files/conda-environment.yaml
2023-10-23 11:20:10,632 INFO    Thread-23 :103779 [upload_job.py:push():138] Uploaded file ./wandb/run-20231023_112000-2qgi689v/files/config.yaml
2023-10-23 11:20:10,659 INFO    Thread-24 :103779 [upload_job.py:push():138] Uploaded file ./wandb/run-20231023_112000-2qgi689v/files/output.log
2023-10-23 11:20:10,690 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 15363
  total_bytes: 15363
}

2023-10-23 11:20:10,797 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 15363
  total_bytes: 15363
}

2023-10-23 11:20:10,860 INFO    Thread-9  :103779 [sender.py:transition_state():393] send defer: 8
2023-10-23 11:20:10,861 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 8
2023-10-23 11:20:10,861 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 8
2023-10-23 11:20:11,022 INFO    SenderThread:103779 [sender.py:transition_state():393] send defer: 9
2023-10-23 11:20:11,024 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 9
2023-10-23 11:20:11,024 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 9
2023-10-23 11:20:11,025 INFO    SenderThread:103779 [sender.py:transition_state():393] send defer: 10
2023-10-23 11:20:11,025 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 15363
  total_bytes: 15363
}

2023-10-23 11:20:11,028 INFO    HandlerThread:103779 [handler.py:handle_request_defer():163] handle defer: 10
2023-10-23 11:20:11,029 INFO    SenderThread:103779 [sender.py:send_request_defer():389] handle sender defer: 10
2023-10-23 11:20:11,127 INFO    SenderThread:103779 [file_pusher.py:join():176] waiting for file pusher
2023-10-23 11:20:11,399 INFO    MainThread:103779 [wandb_run.py:_on_finish():1991] got exit ret: done: true
exit_result {
}
file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 15363
  total_bytes: 15363
}
local_info {
}

2023-10-23 11:20:11,504 INFO    HandlerThread:103779 [handler.py:finish():806] shutting down handler
2023-10-23 11:20:12,027 INFO    WriterThread:103779 [datastore.py:close():279] close: ./wandb/run-20231023_112000-2qgi689v/run-2qgi689v.wandb
2023-10-23 11:20:12,399 INFO    SenderThread:103779 [sender.py:finish():1114] shutting down sender
2023-10-23 11:20:12,399 INFO    SenderThread:103779 [file_pusher.py:finish():171] shutting down file pusher
2023-10-23 11:20:12,399 INFO    SenderThread:103779 [file_pusher.py:join():176] waiting for file pusher
2023-10-23 11:20:12,506 INFO    MainThread:103779 [wandb_run.py:_footer_history_summary_info():3099] rendering history
2023-10-23 11:20:12,506 INFO    MainThread:103779 [wandb_run.py:_footer_history_summary_info():3131] rendering summary
2023-10-23 11:20:12,510 INFO    MainThread:103779 [wandb_run.py:_footer_sync_info():3055] logging synced files
2023-10-23 11:20:12,511 INFO    MainThread:103779 [internal.py:handle_exit():80] Internal process exited
